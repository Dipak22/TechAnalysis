
    <html>
    <head>
        <title>Multi-Timeframe Stock Analysis Report</title>
        <style>
            body { font-family: Arial; margin: 20px; }
            h1 { color: #333366; }
            table { border-collapse: collapse; width: 100%; }
            th, td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
            tr:hover { background-color: #f5f5f5; }
            .buy { background-color: #e6ffe6; }
            .strong-buy { background-color: #ccffcc; }
            .sell { background-color: #ffe6e6; }
            .strong-sell { background-color: #ffcccc; }
            .hold { background-color: #ffffe6; }
            .positive { color: green; }
            .negative { color: red; }
            .neutral { color: gray; }
            .score-bar {
                height: 20px;
                background: linear-gradient(to right, red, yellow, green);
                position: relative;
                border-radius: 3px;
            }
            .score-value {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                width: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: bold;
            }
        </style>
    </head>
    <body>
        <h1>Multi-Timeframe Stock Analysis Report (2025-06-18)</h1>
        <h3>Analysis Periods: Short (10D), Medium (20D), Long (50D)</h3>
        <table>
            <tr>
                <th>Rank</th>
                <th>Ticker</th>
                <th>Price</th>
                <th>10D Chg</th>
                <th>20D Chg</th>
                <th>50D Chg</th>
                <th>RSI (10/20)</th>
                <th>Stoch %K</th>
                <th>MACD Diff</th>
                <th>BB %</th>
                <th>SMA (10/20/50)</th>
                <th>PSAR (10/20/50)</th>
                <th>Volume</th>
                <th>Score</th>
                <th>Signal</th>
            </tr>
            
                <tr class="{
                    'strong-buy' if 'STRONG BUY' in r['Signal'] else
                    'buy' if 'BUY' in r['Signal'] else
                    'strong-sell' if 'STRONG SELL' in r['Signal'] else
                    'sell' if 'SELL' in r['Signal'] else 'hold'
                }">
                    <td>1</td>
                    <td><b>SAMHI.NS</b></td>
                    <td>221.78</td>
                    <td class="{'positive' if float(r[f'Change_10D'].strip('%')) > 0 else 'negative'}">
                        6.8%
                    </td>
                    <td class="{'positive' if float(r[f'Change_20D'].strip('%')) > 0 else 'negative'}">
                        19.9%
                    </td>
                    <td class="{'positive' if float(r[f'Change_50D'].strip('%')) > 0 else 'negative'}">
                        50.4%
                    </td>
                    <td>
                        <span class="{'positive' if float(r[f'RSI_10']) < 30 else 'negative' if float(r[f'RSI_10']) > 70 else 'neutral'}">
                            69.3
                        </span>/
                        <span class="{'positive' if float(r[f'RSI_20']) < 30 else 'negative' if float(r[f'RSI_20']) > 70 else 'neutral'}">
                            67.6
                        </span>
                    </td>
                    <td class="{'positive' if float(r[f'Stoch_%K_10']) < 20 else 'negative' if float(r[f'Stoch_%K_10']) > 80 else 'neutral'}">
                        64.3
                    </td>
                    <td class="{'positive' if float(r[f'MACD_diff_20']) > 0 else 'negative'}">
                        0.351
                    </td>
                    <td class="{'positive' if float(r['BB_%'].strip('%'))/100 < 0.2 else 'negative' if float(r['BB_%'].strip('%'))/100 > 0.8 else 'neutral'}">
                        90.39%
                    </td>
                    <td>219.2/207.5/187.1</td>
                    <td>
                        <span class="{'positive' if r[f'PSAR_10'] == 'Bullish' else 'negative'}">
                            Bullish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_20'] == 'Bullish' else 'negative'}">
                            Bullish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_50'] == 'Bullish' else 'negative'}">
                            Bullish
                        </span>
                    </td>
                    <td>
                        0.4M 
                        <span class="{'positive' if r['Volume_Spike'] == 'Yes' else 'neutral'}">
                            (No) ↑
                        </span>
                    </td>
                    <td>
                        <div class="score-bar">
                            <div class="score-value">100.0</div>
                        </div>
                    </td>
                    <td><b class="{'positive' if 'BUY' in r['Signal'] else 'negative' if 'SELL' in r['Signal'] else 'neutral'}">
                        STRONG BUY (Multi-Timeframe PSAR + Bullish Pattern) [PSAR Bullish (All Timeframes), Strong Trend (ADX > 25), Morning Star Pattern (Strong Bullish), BB Upper Band (90.39%), Price Above VWAP]
                    </b></td>
                </tr>
                
                <tr class="{
                    'strong-buy' if 'STRONG BUY' in r['Signal'] else
                    'buy' if 'BUY' in r['Signal'] else
                    'strong-sell' if 'STRONG SELL' in r['Signal'] else
                    'sell' if 'SELL' in r['Signal'] else 'hold'
                }">
                    <td>2</td>
                    <td><b>BEL.NS</b></td>
                    <td>401.75</td>
                    <td class="{'positive' if float(r[f'Change_10D'].strip('%')) > 0 else 'negative'}">
                        2.9%
                    </td>
                    <td class="{'positive' if float(r[f'Change_20D'].strip('%')) > 0 else 'negative'}">
                        4.9%
                    </td>
                    <td class="{'positive' if float(r[f'Change_50D'].strip('%')) > 0 else 'negative'}">
                        39.7%
                    </td>
                    <td>
                        <span class="{'positive' if float(r[f'RSI_10']) < 30 else 'negative' if float(r[f'RSI_10']) > 70 else 'neutral'}">
                            70.2
                        </span>/
                        <span class="{'positive' if float(r[f'RSI_20']) < 30 else 'negative' if float(r[f'RSI_20']) > 70 else 'neutral'}">
                            72.1
                        </span>
                    </td>
                    <td class="{'positive' if float(r[f'Stoch_%K_10']) < 20 else 'negative' if float(r[f'Stoch_%K_10']) > 80 else 'neutral'}">
                        79.5
                    </td>
                    <td class="{'positive' if float(r[f'MACD_diff_20']) > 0 else 'negative'}">
                        -1.794
                    </td>
                    <td class="{'positive' if float(r['BB_%'].strip('%'))/100 < 0.2 else 'negative' if float(r['BB_%'].strip('%'))/100 > 0.8 else 'neutral'}">
                        84.04%
                    </td>
                    <td>394.5/390.0/342.6</td>
                    <td>
                        <span class="{'positive' if r[f'PSAR_10'] == 'Bullish' else 'negative'}">
                            Bullish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_20'] == 'Bullish' else 'negative'}">
                            Bullish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_50'] == 'Bullish' else 'negative'}">
                            Bullish
                        </span>
                    </td>
                    <td>
                        24.4M 
                        <span class="{'positive' if r['Volume_Spike'] == 'Yes' else 'neutral'}">
                            (No) ↓
                        </span>
                    </td>
                    <td>
                        <div class="score-bar">
                            <div class="score-value">100.0</div>
                        </div>
                    </td>
                    <td><b class="{'positive' if 'BUY' in r['Signal'] else 'negative' if 'SELL' in r['Signal'] else 'neutral'}">
                        HOLD (Conflicting signals: PSAR Bullish (All Timeframes), Strong Trend (ADX > 25), Short-term RSI Overbought (70.2), BB Upper Band (84.04%), Price Above VWAP)
                    </b></td>
                </tr>
                
                <tr class="{
                    'strong-buy' if 'STRONG BUY' in r['Signal'] else
                    'buy' if 'BUY' in r['Signal'] else
                    'strong-sell' if 'STRONG SELL' in r['Signal'] else
                    'sell' if 'SELL' in r['Signal'] else 'hold'
                }">
                    <td>3</td>
                    <td><b>JMFINANCIL.NS</b></td>
                    <td>143.52</td>
                    <td class="{'positive' if float(r[f'Change_10D'].strip('%')) > 0 else 'negative'}">
                        3.2%
                    </td>
                    <td class="{'positive' if float(r[f'Change_20D'].strip('%')) > 0 else 'negative'}">
                        18.2%
                    </td>
                    <td class="{'positive' if float(r[f'Change_50D'].strip('%')) > 0 else 'negative'}">
                        53.6%
                    </td>
                    <td>
                        <span class="{'positive' if float(r[f'RSI_10']) < 30 else 'negative' if float(r[f'RSI_10']) > 70 else 'neutral'}">
                            66.3
                        </span>/
                        <span class="{'positive' if float(r[f'RSI_20']) < 30 else 'negative' if float(r[f'RSI_20']) > 70 else 'neutral'}">
                            68.1
                        </span>
                    </td>
                    <td class="{'positive' if float(r[f'Stoch_%K_10']) < 20 else 'negative' if float(r[f'Stoch_%K_10']) > 80 else 'neutral'}">
                        60.6
                    </td>
                    <td class="{'positive' if float(r[f'MACD_diff_20']) > 0 else 'negative'}">
                        -0.332
                    </td>
                    <td class="{'positive' if float(r['BB_%'].strip('%'))/100 < 0.2 else 'negative' if float(r['BB_%'].strip('%'))/100 > 0.8 else 'neutral'}">
                        89.29%
                    </td>
                    <td>144.1/134.2/114.6</td>
                    <td>
                        <span class="{'positive' if r[f'PSAR_10'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_20'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_50'] == 'Bullish' else 'negative'}">
                            Bullish
                        </span>
                    </td>
                    <td>
                        4.4M 
                        <span class="{'positive' if r['Volume_Spike'] == 'Yes' else 'neutral'}">
                            (No) ↑
                        </span>
                    </td>
                    <td>
                        <div class="score-bar">
                            <div class="score-value">100.0</div>
                        </div>
                    </td>
                    <td><b class="{'positive' if 'BUY' in r['Signal'] else 'negative' if 'SELL' in r['Signal'] else 'neutral'}">
                        HOLD (Conflicting signals: Strong Trend (ADX > 25), Piercing Line (Bullish), BB Upper Band (89.29%), Price Above VWAP)
                    </b></td>
                </tr>
                
                <tr class="{
                    'strong-buy' if 'STRONG BUY' in r['Signal'] else
                    'buy' if 'BUY' in r['Signal'] else
                    'strong-sell' if 'STRONG SELL' in r['Signal'] else
                    'sell' if 'SELL' in r['Signal'] else 'hold'
                }">
                    <td>4</td>
                    <td><b>LTFOODS.NS</b></td>
                    <td>444.35</td>
                    <td class="{'positive' if float(r[f'Change_10D'].strip('%')) > 0 else 'negative'}">
                        -2.7%
                    </td>
                    <td class="{'positive' if float(r[f'Change_20D'].strip('%')) > 0 else 'negative'}">
                        10.5%
                    </td>
                    <td class="{'positive' if float(r[f'Change_50D'].strip('%')) > 0 else 'negative'}">
                        26.0%
                    </td>
                    <td>
                        <span class="{'positive' if float(r[f'RSI_10']) < 30 else 'negative' if float(r[f'RSI_10']) > 70 else 'neutral'}">
                            53.4
                        </span>/
                        <span class="{'positive' if float(r[f'RSI_20']) < 30 else 'negative' if float(r[f'RSI_20']) > 70 else 'neutral'}">
                            59.8
                        </span>
                    </td>
                    <td class="{'positive' if float(r[f'Stoch_%K_10']) < 20 else 'negative' if float(r[f'Stoch_%K_10']) > 80 else 'neutral'}">
                        15.5
                    </td>
                    <td class="{'positive' if float(r[f'MACD_diff_20']) > 0 else 'negative'}">
                        -3.728
                    </td>
                    <td class="{'positive' if float(r['BB_%'].strip('%'))/100 < 0.2 else 'negative' if float(r['BB_%'].strip('%'))/100 > 0.8 else 'neutral'}">
                        78.70%
                    </td>
                    <td>460.0/443.5/391.7</td>
                    <td>
                        <span class="{'positive' if r[f'PSAR_10'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_20'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_50'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>
                    </td>
                    <td>
                        0.1M 
                        <span class="{'positive' if r['Volume_Spike'] == 'Yes' else 'neutral'}">
                            (No) ↑
                        </span>
                    </td>
                    <td>
                        <div class="score-bar">
                            <div class="score-value">100.0</div>
                        </div>
                    </td>
                    <td><b class="{'positive' if 'BUY' in r['Signal'] else 'negative' if 'SELL' in r['Signal'] else 'neutral'}">
                        HOLD (Conflicting signals: Stochastic Oversold, Price Above VWAP)
                    </b></td>
                </tr>
                
                <tr class="{
                    'strong-buy' if 'STRONG BUY' in r['Signal'] else
                    'buy' if 'BUY' in r['Signal'] else
                    'strong-sell' if 'STRONG SELL' in r['Signal'] else
                    'sell' if 'SELL' in r['Signal'] else 'hold'
                }">
                    <td>5</td>
                    <td><b>RPOWER.NS</b></td>
                    <td>62.28</td>
                    <td class="{'positive' if float(r[f'Change_10D'].strip('%')) > 0 else 'negative'}">
                        2.3%
                    </td>
                    <td class="{'positive' if float(r[f'Change_20D'].strip('%')) > 0 else 'negative'}">
                        39.7%
                    </td>
                    <td class="{'positive' if float(r[f'Change_50D'].strip('%')) > 0 else 'negative'}">
                        50.6%
                    </td>
                    <td>
                        <span class="{'positive' if float(r[f'RSI_10']) < 30 else 'negative' if float(r[f'RSI_10']) > 70 else 'neutral'}">
                            54.2
                        </span>/
                        <span class="{'positive' if float(r[f'RSI_20']) < 30 else 'negative' if float(r[f'RSI_20']) > 70 else 'neutral'}">
                            61.3
                        </span>
                    </td>
                    <td class="{'positive' if float(r[f'Stoch_%K_10']) < 20 else 'negative' if float(r[f'Stoch_%K_10']) > 80 else 'neutral'}">
                        14.3
                    </td>
                    <td class="{'positive' if float(r[f'MACD_diff_20']) > 0 else 'negative'}">
                        -0.348
                    </td>
                    <td class="{'positive' if float(r['BB_%'].strip('%'))/100 < 0.2 else 'negative' if float(r['BB_%'].strip('%'))/100 > 0.8 else 'neutral'}">
                        82.13%
                    </td>
                    <td>65.9/60.1/49.1</td>
                    <td>
                        <span class="{'positive' if r[f'PSAR_10'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_20'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_50'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>
                    </td>
                    <td>
                        22.4M 
                        <span class="{'positive' if r['Volume_Spike'] == 'Yes' else 'neutral'}">
                            (No) ↓
                        </span>
                    </td>
                    <td>
                        <div class="score-bar">
                            <div class="score-value">100.0</div>
                        </div>
                    </td>
                    <td><b class="{'positive' if 'BUY' in r['Signal'] else 'negative' if 'SELL' in r['Signal'] else 'neutral'}">
                        HOLD (Conflicting signals: Strong Trend (ADX > 25), Stochastic Oversold, BB Upper Band (82.13%), Price Above VWAP)
                    </b></td>
                </tr>
                
                <tr class="{
                    'strong-buy' if 'STRONG BUY' in r['Signal'] else
                    'buy' if 'BUY' in r['Signal'] else
                    'strong-sell' if 'STRONG SELL' in r['Signal'] else
                    'sell' if 'SELL' in r['Signal'] else 'hold'
                }">
                    <td>6</td>
                    <td><b>ZEEL.NS</b></td>
                    <td>135.00</td>
                    <td class="{'positive' if float(r[f'Change_10D'].strip('%')) > 0 else 'negative'}">
                        5.7%
                    </td>
                    <td class="{'positive' if float(r[f'Change_20D'].strip('%')) > 0 else 'negative'}">
                        6.1%
                    </td>
                    <td class="{'positive' if float(r[f'Change_50D'].strip('%')) > 0 else 'negative'}">
                        28.9%
                    </td>
                    <td>
                        <span class="{'positive' if float(r[f'RSI_10']) < 30 else 'negative' if float(r[f'RSI_10']) > 70 else 'neutral'}">
                            63.3
                        </span>/
                        <span class="{'positive' if float(r[f'RSI_20']) < 30 else 'negative' if float(r[f'RSI_20']) > 70 else 'neutral'}">
                            62.9
                        </span>
                    </td>
                    <td class="{'positive' if float(r[f'Stoch_%K_10']) < 20 else 'negative' if float(r[f'Stoch_%K_10']) > 80 else 'neutral'}">
                        51.8
                    </td>
                    <td class="{'positive' if float(r[f'MACD_diff_20']) > 0 else 'negative'}">
                        0.160
                    </td>
                    <td class="{'positive' if float(r['BB_%'].strip('%'))/100 < 0.2 else 'negative' if float(r['BB_%'].strip('%'))/100 > 0.8 else 'neutral'}">
                        84.22%
                    </td>
                    <td>132.7/130.5/120.2</td>
                    <td>
                        <span class="{'positive' if r[f'PSAR_10'] == 'Bullish' else 'negative'}">
                            Bullish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_20'] == 'Bullish' else 'negative'}">
                            Bullish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_50'] == 'Bullish' else 'negative'}">
                            Bullish
                        </span>
                    </td>
                    <td>
                        5.5M 
                        <span class="{'positive' if r['Volume_Spike'] == 'Yes' else 'neutral'}">
                            (No) ↓
                        </span>
                    </td>
                    <td>
                        <div class="score-bar">
                            <div class="score-value">100.0</div>
                        </div>
                    </td>
                    <td><b class="{'positive' if 'BUY' in r['Signal'] else 'negative' if 'SELL' in r['Signal'] else 'neutral'}">
                        HOLD (Conflicting signals: PSAR Bullish (All Timeframes), Strong Trend (ADX > 25), BB Upper Band (84.22%), Price Above VWAP)
                    </b></td>
                </tr>
                
                <tr class="{
                    'strong-buy' if 'STRONG BUY' in r['Signal'] else
                    'buy' if 'BUY' in r['Signal'] else
                    'strong-sell' if 'STRONG SELL' in r['Signal'] else
                    'sell' if 'SELL' in r['Signal'] else 'hold'
                }">
                    <td>7</td>
                    <td><b>DLF.NS</b></td>
                    <td>851.45</td>
                    <td class="{'positive' if float(r[f'Change_10D'].strip('%')) > 0 else 'negative'}">
                        6.0%
                    </td>
                    <td class="{'positive' if float(r[f'Change_20D'].strip('%')) > 0 else 'negative'}">
                        9.8%
                    </td>
                    <td class="{'positive' if float(r[f'Change_50D'].strip('%')) > 0 else 'negative'}">
                        25.2%
                    </td>
                    <td>
                        <span class="{'positive' if float(r[f'RSI_10']) < 30 else 'negative' if float(r[f'RSI_10']) > 70 else 'neutral'}">
                            65.4
                        </span>/
                        <span class="{'positive' if float(r[f'RSI_20']) < 30 else 'negative' if float(r[f'RSI_20']) > 70 else 'neutral'}">
                            66.3
                        </span>
                    </td>
                    <td class="{'positive' if float(r[f'Stoch_%K_10']) < 20 else 'negative' if float(r[f'Stoch_%K_10']) > 80 else 'neutral'}">
                        61.2
                    </td>
                    <td class="{'positive' if float(r[f'MACD_diff_20']) > 0 else 'negative'}">
                        -1.007
                    </td>
                    <td class="{'positive' if float(r['BB_%'].strip('%'))/100 < 0.2 else 'negative' if float(r['BB_%'].strip('%'))/100 > 0.8 else 'neutral'}">
                        87.45%
                    </td>
                    <td>853.4/819.6/730.9</td>
                    <td>
                        <span class="{'positive' if r[f'PSAR_10'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_20'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_50'] == 'Bullish' else 'negative'}">
                            Bullish
                        </span>
                    </td>
                    <td>
                        5.3M 
                        <span class="{'positive' if r['Volume_Spike'] == 'Yes' else 'neutral'}">
                            (No) ↓
                        </span>
                    </td>
                    <td>
                        <div class="score-bar">
                            <div class="score-value">97.1</div>
                        </div>
                    </td>
                    <td><b class="{'positive' if 'BUY' in r['Signal'] else 'negative' if 'SELL' in r['Signal'] else 'neutral'}">
                        HOLD (Conflicting signals: Strong Trend (ADX > 25), Bearish Engulfing Pattern, Evening Star Pattern (Strong Bearish), Dark Cloud Cover (Bearish), BB Upper Band (87.45%), Price Above VWAP)
                    </b></td>
                </tr>
                
                <tr class="{
                    'strong-buy' if 'STRONG BUY' in r['Signal'] else
                    'buy' if 'BUY' in r['Signal'] else
                    'strong-sell' if 'STRONG SELL' in r['Signal'] else
                    'sell' if 'SELL' in r['Signal'] else 'hold'
                }">
                    <td>8</td>
                    <td><b>PARADEEP.NS</b></td>
                    <td>165.97</td>
                    <td class="{'positive' if float(r[f'Change_10D'].strip('%')) > 0 else 'negative'}">
                        -5.9%
                    </td>
                    <td class="{'positive' if float(r[f'Change_20D'].strip('%')) > 0 else 'negative'}">
                        5.8%
                    </td>
                    <td class="{'positive' if float(r[f'Change_50D'].strip('%')) > 0 else 'negative'}">
                        39.2%
                    </td>
                    <td>
                        <span class="{'positive' if float(r[f'RSI_10']) < 30 else 'negative' if float(r[f'RSI_10']) > 70 else 'neutral'}">
                            46.3
                        </span>/
                        <span class="{'positive' if float(r[f'RSI_20']) < 30 else 'negative' if float(r[f'RSI_20']) > 70 else 'neutral'}">
                            56.8
                        </span>
                    </td>
                    <td class="{'positive' if float(r[f'Stoch_%K_10']) < 20 else 'negative' if float(r[f'Stoch_%K_10']) > 80 else 'neutral'}">
                        3.3
                    </td>
                    <td class="{'positive' if float(r[f'MACD_diff_20']) > 0 else 'negative'}">
                        -1.957
                    </td>
                    <td class="{'positive' if float(r['BB_%'].strip('%'))/100 < 0.2 else 'negative' if float(r['BB_%'].strip('%'))/100 > 0.8 else 'neutral'}">
                        70.34%
                    </td>
                    <td>172.6/169.5/151.9</td>
                    <td>
                        <span class="{'positive' if r[f'PSAR_10'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_20'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_50'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>
                    </td>
                    <td>
                        1.2M 
                        <span class="{'positive' if r['Volume_Spike'] == 'Yes' else 'neutral'}">
                            (No) ↓
                        </span>
                    </td>
                    <td>
                        <div class="score-bar">
                            <div class="score-value">64.5</div>
                        </div>
                    </td>
                    <td><b class="{'positive' if 'BUY' in r['Signal'] else 'negative' if 'SELL' in r['Signal'] else 'neutral'}">
                        HOLD (Conflicting signals: Strong Trend (ADX > 25), Stochastic Oversold, Price Above VWAP, Short-term Down 5.9%)
                    </b></td>
                </tr>
                
                <tr class="{
                    'strong-buy' if 'STRONG BUY' in r['Signal'] else
                    'buy' if 'BUY' in r['Signal'] else
                    'strong-sell' if 'STRONG SELL' in r['Signal'] else
                    'sell' if 'SELL' in r['Signal'] else 'hold'
                }">
                    <td>9</td>
                    <td><b>JIOFIN.NS</b></td>
                    <td>289.80</td>
                    <td class="{'positive' if float(r[f'Change_10D'].strip('%')) > 0 else 'negative'}">
                        -0.2%
                    </td>
                    <td class="{'positive' if float(r[f'Change_20D'].strip('%')) > 0 else 'negative'}">
                        5.6%
                    </td>
                    <td class="{'positive' if float(r[f'Change_50D'].strip('%')) > 0 else 'negative'}">
                        25.8%
                    </td>
                    <td>
                        <span class="{'positive' if float(r[f'RSI_10']) < 30 else 'negative' if float(r[f'RSI_10']) > 70 else 'neutral'}">
                            51.3
                        </span>/
                        <span class="{'positive' if float(r[f'RSI_20']) < 30 else 'negative' if float(r[f'RSI_20']) > 70 else 'neutral'}">
                            59.2
                        </span>
                    </td>
                    <td class="{'positive' if float(r[f'Stoch_%K_10']) < 20 else 'negative' if float(r[f'Stoch_%K_10']) > 80 else 'neutral'}">
                        30.0
                    </td>
                    <td class="{'positive' if float(r[f'MACD_diff_20']) > 0 else 'negative'}">
                        -1.512
                    </td>
                    <td class="{'positive' if float(r['BB_%'].strip('%'))/100 < 0.2 else 'negative' if float(r['BB_%'].strip('%'))/100 > 0.8 else 'neutral'}">
                        74.54%
                    </td>
                    <td>296.0/289.9/266.7</td>
                    <td>
                        <span class="{'positive' if r[f'PSAR_10'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_20'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>/
                        <span class="{'positive' if r[f'PSAR_50'] == 'Bullish' else 'negative'}">
                            Bearish
                        </span>
                    </td>
                    <td>
                        8.9M 
                        <span class="{'positive' if r['Volume_Spike'] == 'Yes' else 'neutral'}">
                            (No) ↓
                        </span>
                    </td>
                    <td>
                        <div class="score-bar">
                            <div class="score-value">45.5</div>
                        </div>
                    </td>
                    <td><b class="{'positive' if 'BUY' in r['Signal'] else 'negative' if 'SELL' in r['Signal'] else 'neutral'}">
                        HOLD (Conflicting signals: Bearish Engulfing Pattern, Evening Star Pattern (Strong Bearish), Dark Cloud Cover (Bearish), Price Above VWAP)
                    </b></td>
                </tr>
                
        </table>
        <h3>Indicator Legend:</h3>
        <ul>
            <li><b>Timeframes</b>: Short (10D), Medium (20D), Long (50D)</li>
            <li><b>PSAR</b>: Bullish (Price > SAR), Bearish (Price < SAR)</li>
            <li><b>Score</b>: 0-100 (Higher = Stronger Bullish)</li>
            <li><b>Signal Strength</b>:
                <ul>
                    <li><span class="strong-buy">STRONG BUY</span>: All PSAR timeframes bullish + score >80</li>
                    <li><span class="buy">BUY</span>: Partial PSAR bullish + score >65</li>
                    <li><span class="strong-sell">STRONG SELL</span>: All PSAR timeframes bearish + score <20</li>
                    <li><span class="sell">SELL</span>: Partial PSAR bearish + score <35</li>
                </ul>
            </li>
        </ul>
    </body>
    </html>
    